# 首页动态化实施方案

本方案基于现有的 `front-page.php` 模块化结构，利用 **Advanced Custom Fields (ACF)** 插件将所有静态硬编码内容转换为后台可配置的动态内容。

## 1. 总体策略

*   **单一入口**：所有首页字段配置在同一个 ACF Field Group "Front Page Settings" 中。
*   **Tab 分组**：利用 ACF 的 Tab 字段，将 Field Group 按页面模块（Hero, Stats, About 等）分为不同的标签页，与前端视觉区块一一对应。
*   **按需加载**：每个 template part 文件只读取其对应的 ACF 字段，保持代码解耦。
*   **组件复用**：对于“标题+描述+按钮”这种常见组合，或者“图标+标题+文字”的卡片结构，在 ACF 中使用 Clone 字段或标准命名规范，减少重复配置工作。

## 2. ACF 字段组规划 (Front Page Settings)

建议创建一个字段组，Location 设置为 **Page Type** 等于 **Front Page**。

### Tab 1: Hero Section (`home-hero.php`)
| 字段 Label | 字段 Name | 类型 | 说明 |
| :--- | :--- | :--- | :--- |
| **Hero Content** | `tab_hero` | Tab | |
| Background Type | `hero_bg_type` | Select | 选项: Video, Image |
| Video File | `hero_video` | File | 返回 URL (用于 Video 背景) |
| Background Image | `hero_image` | Image | 返回 ID (用于 Image 背景) |
| Subtitle | `hero_subtitle` | Text | 例如: "LEaD BY PASSIONATE Technicians" |
| Main Title | `hero_title` | Text | 例如: "The leading of..." |
| Description | `hero_desc` | Text Area | |
| Button 1 Text | `hero_btn1_text` | Text | "Explore Product" |
| Button 1 URL | `hero_btn1_url` | URL | |
| Button 2 Text | `hero_btn2_text` | Text | "ABOUT US" |
| Button 2 URL | `hero_btn2_url` | URL | |

### Tab 2: Stats Section (`home-stats.php`)
| 字段 Label | 字段 Name | 类型 | 说明 |
| :--- | :--- | :--- | :--- |
| **Stats** | `tab_stats` | Tab | |
| Title | `stats_title` | Text | |
| Description | `stats_desc` | Text Area | |
| CTA Button Text | `stats_btn_text` | Text | |
| CTA Button URL | `stats_btn_url` | URL | |
| Stats Items | `stats_items` | Repeater | 右侧数据网格 |
| - Icon | `icon` | Image | 建议上传 SVG |
| - Number | `number` | Text | "1350" |
| - Label | `label` | Text | "Global Customers" |

### Tab 3: About Intro (`section-about-intro.php`)
| 字段 Label | 字段 Name | 类型 | 说明 |
| :--- | :--- | :--- | :--- |
| **About Intro** | `tab_about` | Tab | |
| Image | `about_intro_image` | Image | 左侧大图 |
| Title | `about_intro_title` | Text | "who we are" |
| Description | `about_intro_desc` | Text Area | |
| Subtitle | `about_intro_subtitle` | Text | 内部小标题 |
| Feature List | `about_intro_list` | Repeater | |
| - Icon | `icon` | Image | |
| - Text | `text` | Text | |

### Tab 4: Category Grid (`section-category-grid.php`)
| 字段 Label | 字段 Name | 类型 | 说明 |
| :--- | :--- | :--- | :--- |
| **Category Grid** | `tab_cat_grid` | Tab | |
| Section Title | `cat_grid_title` | Text | |
| Grid Items | `cat_grid_items` | Repeater | |
| - Background Image | `image` | Image | |
| - Icon | `icon` | Image | 悬浮显示的图标 |
| - Title | `title` | Text | |
| - Description | `desc` | Text Area | |
| - Link | `link` | URL | 点击跳转地址 |

### Tab 5: Industry Grid (`section-industry-grid.php`)
*结构与 Category Grid 类似，建议复用或独立配置。*
| 字段 Label | 字段 Name | 类型 | 说明 |
| :--- | :--- | :--- | :--- |
| **Industry Grid** | `tab_industry` | Tab | |
| Industry Items | `industry_items` | Repeater | |
| - Image | `image` | Image | |
| - Icon | `icon` | Image | |
| - Title | `title` | Text | |
| - Description | `desc` | Text Area | |
| - Link | `link` | URL | |

### Tab 6: Why Choose Us (`section-feature-media.php`)
| 字段 Label | 字段 Name | 类型 | 说明 |
| :--- | :--- | :--- | :--- |
| **Why Choose Us** | `tab_wcu` | Tab | |
| Title | `wcu_title` | Text | |
| Description | `wcu_desc` | Text Area | |
| Features | `wcu_features` | Repeater | 左侧列表 |
| - Icon | `icon` | Image | |
| - Text | `text` | Text | |
| Button Text | `wcu_btn_text` | Text | |
| Button URL | `wcu_btn_url` | URL | |
| Right Image | `wcu_image` | Image | |
| Video URL | `wcu_video_url` | URL | YouTube/MP4 链接 |

### Tab 7: Feature Products (`section-product-grid.php`)
| 字段 Label | 字段 Name | 类型 | 说明 |
| :--- | :--- | :--- | :--- |
| **Feature Products** | `tab_feat_prod` | Tab | |
| Title | `feat_prod_title` | Text | |
| Products | `feat_prod_items` | Repeater | 手动配置产品展示 |
| - Image | `image` | Image | |
| - Title | `title` | Text | |
| - Link | `link` | URL | |
| - Price (Optional) | `price` | Text | 可选 |

### Tab 8: Service Grid (`section-service-grid.php`)
| 字段 Label | 字段 Name | 类型 | 说明 |
| :--- | :--- | :--- | :--- |
| **Services** | `tab_service` | Tab | |
| Title | `service_title` | Text | |
| Service Items | `service_items` | Repeater | |
| - Icon | `icon` | Image | |
| - Title | `title` | Text | |
| - Description | `desc` | Text Area | |
| - Link | `link` | URL | |

### Tab 9: Project Grid (`section-project-grid.php`)
| 字段 Label | 字段 Name | 类型 | 说明 |
| :--- | :--- | :--- | :--- |
| **Projects** | `tab_project` | Tab | |
| Title | `project_title` | Text | |
| Description | `project_desc` | Text Area | |
| Button Text | `project_btn_text` | Text | |
| Button URL | `project_btn_url` | URL | |
| Collage Images | `project_collage` | Gallery | 右侧堆叠的图片集 |
| Project Items | `project_items` | Relationship | 关联 Project (CPT) 或 Manual Repeater |

---

## 3. 模板代码修改示例

以下展示如何在 template parts 中调用 ACF 数据。

### 示例 1: `home-hero.php`

```php
<?php
// 获取字段
$bg_type = get_field('hero_bg_type');
$video_url = get_field('hero_video');
$title = get_field('hero_title');
// ... 其他字段

// 动态输出
?>
<section ...>
    <?php if($bg_type == 'video' && $video_url): ?>
        <div class="elementor-background-video-container">
            <video src="<?php echo esc_url($video_url); ?>" autoplay muted loop></video>
        </div>
    <?php endif; ?>
    
    <!-- 内容替换 -->
    <h2 class="elementor-heading-title"><?php echo esc_html($title); ?></h2>
    
    <!-- 按钮 -->
    <a href="<?php echo esc_url(get_field('hero_btn1_url')); ?>">
        <?php echo esc_html(get_field('hero_btn1_text')); ?>
    </a>
</section>
```

### 示例 2: Repeater 循环 (`home-stats.php`)

```php
<?php if( have_rows('stats_items') ): ?>
    <?php while( have_rows('stats_items') ): the_row(); 
        $icon = get_sub_field('icon');
        $number = get_sub_field('number');
        $label = get_sub_field('label');
    ?>
    <div class="elementor-column ...">
        <!-- SVG 图标处理: 如果上传的是 SVG 文件 -->
        <div class="icon">
            <?php 
            if($icon) {
                echo wp_get_attachment_image($icon['id'], 'full'); 
            }
            ?>
        </div>
        <h3><?php echo esc_html($number); ?></h3>
        <p><?php echo esc_html($label); ?></p>
    </div>
    <?php endwhile; ?>
<?php endif; ?>
```

## 4. 复用与联动实现细节

### 4.1 页面间联动 (Linkage)
*   **产品数据联动（原生实现）**：
    *   在 `section-product-grid.php` 中，使用 ACF Repeater 字段 `feat_prod_items` 循环输出产品卡片。
    *   这完全解耦了对 WooCommerce 的依赖，你可以自由链接到任何页面（如静态产品页、文章页或外部链接）。
    *   如果未来使用了 Custom Post Type (CPT) 来管理产品，也可以将 Repeater 中的 Image/Title/Link 字段改为 **Post Object** 字段，直接选择 CPT 文章对象，然后通过 `$post->ID` 获取其缩略图和标题。

*   **项目/案例联动（原生实现）**：
    *   在 Project Grid 中使用 **Relationship** 字段（关联 WordPress 原生的 Post 或 Page）或者 **Repeater** 字段（手动输入）。
    *   如果关联的是 Post/Page，使用 `get_permalink($id)` 和 `get_the_post_thumbnail($id)` 获取数据，完全基于 WordPress 原生功能。

### 4.2 SVG 图标复用
*   目前的 HTML 中包含大量硬编码的 SVG 代码 (Path)。
*   **最佳实践**：不要将 SVG 代码存入 ACF 文本域。
*   **方案**：
    1.  将现有 SVG 保存为 `.svg` 文件。
    2.  在 ACF 中使用 **Image** 字段。
    3.  **开启 SVG 上传支持**（无需额外插件）：
        在主题的 `functions.php` 中添加以下代码，允许管理员上传 SVG 文件：
        ```php
        function elysia_mime_types($mimes) {
            $mimes['svg'] = 'image/svg+xml';
            return $mimes;
        }
        add_filter('upload_mimes', 'elysia_mime_types');
        ```
    4.  前端使用 `wp_get_attachment_image()` 或 `file_get_contents(get_attached_file($icon_id))` (如果需要内联 SVG 以便 CSS 变色) 输出。

## 5. 实施步骤

1.  **安装配置插件**：确保已安装 ACF (Free或Pro版)。无需安装 SVG Support 插件。
2.  **配置环境**：在 `functions.php` 中添加上述 SVG 支持代码。
3.  **创建字段组**：在后台按上述规划逐一创建字段。
3.  **录入数据**：打开首页编辑页面，将现有前台看到的文字、图片、链接录入到 ACF 字段中。
4.  **修改代码**：逐个修改 `template-parts/front-page/` 下的文件，将静态内容替换为 PHP 变量输出。
5.  **验证**：
    *   检查前台显示是否正常。
    *   检查 Elementor 遗留的 `data-id` 是否保留（维持样式）。
    *   检查空值情况（如果没填标题，是否应该隐藏该元素）。

## 6. 特别注意

*   **Elementor 兼容性**：我们保留了外层的 `data-id` 和 class 结构，这能最大程度保留 Elementor 生成的 CSS 样式。但在替换内部内容时，要注意不要误删用于布局的关键 `div` (如 `elementor-widget-container`)。
*   **图片尺寸**：ACF Image 字段返回 Image Array 时，可以使用 `['sizes']['large']` 或 `['sizes']['medium']` 获取合适尺寸的图片，优化加载速度。
