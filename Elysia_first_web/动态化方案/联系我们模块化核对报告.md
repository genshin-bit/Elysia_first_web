# 联系我们页面模块拆分核对报告（`page-contact.php`）

> 依据：  
> - `e:/phpstudy_pro/WWW/wp-content/themes/swforming/全站模块分析.md`  
> - `e:/phpstudy_pro/WWW/wp-content/themes/swforming/模块映射.md`  
> - 当前模板：`e:/phpstudy_pro/WWW/wp-content/themes/Elysia_first_web/page-contact.php`

---

## 一、拆分清单表格

> 说明：  
> - “建议文件名”按要求：优先放在 `template-parts/one_page/` 目录下，命名风格遵守《模块映射.md》（小写 + 连字符）。  
> - 若该区块属于“全站通用模式”，在“重用性评估”中会指出对应的 `components/` 模块，建议直接复用，而不是重复造轮子。

### 1. 区块级拆分清单

| 模块编号 | 建议文件名（位于 `template-parts/one_page/`） | 功能描述 | HTML 标识 / 锚点（在 `page-contact.php` 中） | 重用性评估 |
| --- | --- | --- | --- | --- |
| 1 | `contact-assets.php` | 联系我们页面专用的 CSS/JS 引入，包括 Elementor/Blocksy/WooCommerce 样式与脚本，以及 okki 分析脚本和 `analyze.js` | 紧随 `get_header();` 之后的第一批 `<link rel='stylesheet' ...>` 到 `<script async src="<?php echo get_template_directory_uri(); ?>/static/js/analyze.js"></script>` 这一段 | 页面级私有模块。模式与 `page-solution.php`、`page-solution-detail.php` 类似，但每页所需的 Elementor Widget CSS 不同，不宜抽到 `components`，保留为 `one_page` 级即可。 |
| 2 | `contact-hero.php` | 联系我们页首屏标题区，仅展示大标题 “Contact”，带背景 overlay | `<section ... class="elementor-section ... elementor-element-b36e830 ...">` 内部的 `<h1 class="elementor-heading-title elementor-size-default">Contact</h1>` | 逻辑上属于《全站模块分析.md》中“9) 内容页首屏标题区（Page Hero / Page Title Section）”，与 `page-hero-title` 模式一致。推荐优先复用 `template-parts/components/page-hero-title.php`，本页可视为该组件的一个具体使用场景。若暂不动全站组件，可先落为 `one_page/contact-hero.php`。 |
| 3 | `contact-info-grid.php` | 四列联系方式信息栅格：Tel / Email / WhatsApp / Address，使用 Elementor Icon Box 结构展示联系方式 | `<section ... class="elementor-section ... elementor-element-12252aaf ...">` 下包含 4 个 `.elementor-widget-icon-box`：`elementor-element-28f2505c`（Tel）、`20e25936`（Email）、`4e884454`（WhatsApp）、`179cef8f`（Address） | 当前仅在联系我们页出现，属于“单页内容模块”。其业务内容与全站 Footer 联系方式（`elysia_first_web_get_footer_contacts()`）相似，可复用选项值。建议短期作为 `one_page` 私有模块；中长期可抽象为 `components/contact-info-grid.php`，用于 Footer、Blog Sidebar、单页 Contact 统一维护。 |
| 4 | `contact-form-and-map.php` | 左侧：Lead 获取区 “get in touch / Get Quote & Leave us message” + Zoho 联系表单嵌入；右侧：Google 地图（Wuxi City, Jiangsu Province, China） | `<section ... class="elementor-section ... elementor-element-1229abea ...">`，包含左列 `.elementor-element-8b9d47a` 内的 Zoho iframe 以及右列 `.elementor-element-410a6628` 内的 Google Maps iframe | 强烈建议作为跨页面可复用模块进行抽象：相同的 Zoho 表单 Perma（`pzNRX0a0vTLnd9POzzlI5FD2DQm4WX5_ZfrCo5BuWow`）已在产品列表 CTA 模块 `template-parts/product/archive-contact-us-cta.php` 和 Blog 详情侧边栏联系模块 `template-parts/blog_detail/blog-detail-sidebar-contact.php` 中使用。根据全站复用性，推荐抽象为 `template-parts/components/contact-form-zoho.php`（或同级命名），本页的 `contact-form-and-map.php` 只负责编排 “左表单 + 右地图”，左侧内部直接 `get_template_part('template-parts/components/contact-form-zoho')`。地图部分目前仅联系我们页使用，可视为本模块的页面私有部分。 |

---

## 二、拆分后的 `page-contact.php` 结构预览

> 目标：主模板只负责页面骨架与模块编排，不再直接塞入大段 Elementor 导出的 HTML。

```php
<?php
/**
 * Template Name: 联系我们
 */
get_header();
?>

<?php get_template_part('template-parts/one_page/contact-assets'); ?>

<main id="main" class="site-main hfeed">
    <div class="ct-container-full" data-content="normal">
        <article id="post-155" class="post-155 page type-page status-publish hentry">
            <div class="blocksy-woo-messages-default woocommerce-notices-wrapper">
                <div class="woocommerce"></div>
            </div>
            <div class="entry-content is-layout-constrained">
                <?php
                get_template_part('template-parts/one_page/contact-hero');
                get_template_part('template-parts/one_page/contact-info-grid');
                get_template_part('template-parts/one_page/contact-form-and-map');
                ?>
            </div>
        </article>
    </div>
</main>

<?php
get_footer();
?>
```

若采用“更高复用度”的方案，可以进一步调整为：

- `contact-hero` 内部不再写死 HTML，而是复用全局组件：

  ```php
  <?php
  // template-parts/one_page/contact-hero.php
  get_template_part('template-parts/components/page-hero-title', null, array(
      'title' => 'Contact',
  ));
  ```

- `contact-form-and-map` 内部左侧表单不再直接写 iframe，而是复用 `components/contact-form-zoho.php`（需要先创建这一组件），确保与产品列表 CTA 和 Blog 侧边栏联系组件统一。

---

## 三、复用性与其他页面模块的关系

结合《全站模块分析.md》与现有模板：

- 首屏标题区（Hero）  
  - 对应分析文档中的“9) 内容页首屏标题区（Page Hero / Page Title Section）”。  
  - 在 Solution 详情、Blog 详情等也存在类似结构；已在《模块映射.md》中被规划为 `template-parts/components/page-hero-title.php`。  
  - 联系我们页应尽量复用同一组件，只通过参数或 ACF 配置调整标题与背景。

- Zoho 联系表单  
  - 在以下位置使用了相同或同源的 Zoho 表单：  
    - 产品列表页 CTA 模块：`template-parts/product/archive-contact-us-cta.php`  
    - Blog 详情页侧边栏联系模块：`template-parts/blog_detail/blog-detail-sidebar-contact.php`  
    - 联系我们页主体区域（当前 `page-contact.php` 中直接 iframe）  
  - 建议统一抽象为一个 `components` 级模块，例如：`template-parts/components/contact-form-zoho.php`。  
  - 各页面模块（产品归档 CTA、Blog 侧边栏、联系我们主体）只负责周边文案与布局，表单本体由该组件统一维护。

- 联系方式信息（Tel / Email / Address）  
  - Footer 通过 `elysia_first_web_get_footer_contacts()` 从 `options` 读取电话、邮箱、地址。  
  - 联系我们页的 info grid 内部目前写死了相同信息，建议后续改为读取相同的 Option，以避免信息不一致。  
  - 若在多个页面都需要“联系方式卡片”样式，可抽象为 `template-parts/components/contact-info-grid.php`。当前阶段可以先按 `one_page/contact-info-grid.php` 落地，内部用 `get_option()` 或 ACF Option 来取值，为未来抽象预留空间。

---

## 四、拆分实现时的核心注意项

1. 全局结构与 Hook  
   - 必须保留 `get_header();` 与 `get_footer();` 在主模板中调用，`template-parts/one_page/*` 只输出局部 HTML，不负责 `<html>`、`<head>`、`<body>` 等骨架。  
   - 不要在子模块中重复调用 `get_header()` / `get_footer()`，以免嵌套产生无效 HTML 结构。

2. 全局变量与 WordPress 环境  
   - 当前 `page-contact.php` 没有使用 `$post`、`the_title()`、`the_content()` 或 WooCommerce 的 `$product` 等全局变量；所有内容为静态 HTML + iframe。  
   - 拆分到 `template-parts/one_page/*` 时，保持这些文件仅依赖 WordPress 全局环境（函数如 `get_template_directory_uri()`），不引入额外全局变量即可。  
   - 若未来改为使用 ACF 或 Options 管理标题、联系方式、表单参数，需要注意在子模块内调用 `get_field()` / `get_option()` 时的作用域（如 `'option'` 或当前页面 ID）。

3. 脚本与样式的完整性  
   - `contact-assets.php` 中的 `<link>` 与 `<script>` 顺序尽量保持与当前 `page-contact.php` 相同，避免因顺序改变产生样式覆盖或 JS 依赖问题。  
   - `okkiConfigs` 与 `analyze.js` 的用法应与 `page-blog-detail.php` 保持一致，拆分时将其整体移动到 `contact-assets.php` 中即可。

4. Zoho 表单与地图 iframe  
   - Zoho 表单 iframe 与 Google Maps iframe 内容必须原样迁移，不要对 `src` 做额外处理，以防止已有追踪参数或编码发生变化。  
   - 若抽象为 `components/contact-form-zoho.php`，建议通过 ACF Options 或 `get_option()` 存储 `formperma` 与高度值，这一点已经在 `archive-contact-us-cta.php` 中以 ACF Options 的方式实现，可以复用相同字段。

5. 与其他模块的协同  
   - 若在联系我们页未来引入 Breadcrumb / Share Buttons 等模块，应遵守《模块映射.md》：  
     - Breadcrumb：`template-parts/components/breadcrumbs.php`  
     - Share Buttons：`template-parts/components/share-buttons.php`  
   - 联系我们当前模板中尚未使用这些通用模块，拆分时无需处理，但在扩展时要优先考虑复用这些组件，而不是再写一块新的 Elementor HTML。

---

## 五、总结建议

- 本次拆分建议形成 4 个 `one_page` 模块：`contact-assets`、`contact-hero`、`contact-info-grid`、`contact-form-and-map`。  
- 其中：  
  - `contact-hero` 建议中长期收敛到全站通用组件 `components/page-hero-title`。  
  - `contact-form-and-map` 中的 Zoho 表单，应与产品列表 CTA、Blog 详情侧边栏统一为 `components/contact-form-zoho`。  
  - `contact-info-grid` 建议在使用 `options` 提供数据的前提下，视未来复用情况再考虑升级为 `components` 级模块。

