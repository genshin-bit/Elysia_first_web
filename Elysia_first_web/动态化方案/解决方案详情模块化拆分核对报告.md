**产品列表模块拆分核对报告（基于 page-solution-detail.php）**

---

### 一、拆分清单表格（按业务区块）

> 说明：  
> - “建议文件名”一栏：  
>   - 对于 **Solution 详情私有/类型模块** → 建议放在 `template-parts/solution_detail/`  
>   - 对于 **全站通用模块** → 按《模块映射.md》放在 `components/` / `layout/` / `loop/` 等已有目录，并在表格中标明“已存在/应迁移”  
> - “HTML 标识/锚点”使用当前 `page-solution-detail.php` 中容易搜索的关键选择器/特征串。

#### 1. 站点头部 + 主导航

| 区块 | 建议文件名 | 功能描述 | HTML 标识/锚点 | 重用性评估 |
| --- | --- | --- | --- | --- |
| 桌面端 Site Header（Logo + 主导航 + 社媒） | 不在 `solution_detail/`；复用 `layout/site-header.php` | 站点级头部骨架，包含主导航、LOGO、社交入口等 | `header#header.ct-header`，`class="site-branding"`，`id="header-menu-1"` | **全站公共模块**：已在《模块映射.md》中作为 `site-header` 抽象，应由 `header.php` 调用 `template-parts/layout/site-header.php`，不在 Solution 详情专用目录中再拷贝 |
| 移动端 Header（Logo + 汉堡菜单触发） | 同上 | 移动端顶栏，包含 LOGO 与菜单抽屉触发按钮 | `data-device="mobile"` + `class="ct-header-trigger ct-toggle"` | **全站公共模块**；与桌面 Header 同属 `site-header` |

#### 2. 全站 Overlay / 抽屉类模块

| 区块 | 建议文件名 | 功能描述 | HTML 标识/锚点 | 重用性评估 |
| --- | --- | --- | --- | --- |
| 搜索弹层（Search Modal） | 不在 `solution_detail/`；使用 `components/overlay-search-modal.php` | 全站搜索弹层，支持头部搜索按钮触发 | `id="search-modal"` + `class="ct-panel"`（在文件中） | **全站公共模块**：在《全站模块分析.md》中为 `overlay-search-modal`，应由 `header.php` 统一 `get_template_part('template-parts/components/overlay-search-modal')` 调用 |
| 侧滑抽屉菜单（Offcanvas Menu） | 不在 `solution_detail/`；使用 `components/panel-offcanvas-menu.php` | 移动端 offcanvas 导航容器，与汉堡按钮联动 | `id="offcanvas"` + `class="ct-panel"`，以及 `data-toggle-panel="#offcanvas"` | **全站公共模块**：映射为 `panel-offcanvas-menu`，由 `header.php` 统一挂载 |

#### 3. Solution 详情首屏（面包屑 + 标题 + 日期）

| 区块 | 建议文件名 | 功能描述 | HTML 标识/锚点 | 重用性评估 |
| --- | --- | --- | --- | --- |
| 面包屑导航（Solution 详情） | `solution-detail-hero.php` 中内联调用 `components/breadcrumbs.php` | 展示「Home / Solution / 当前解决方案标题」路径 | `class="elementor-widget-breadcrumbs"`，内部 `<nav class="rank-math-breadcrumb">` | **跨页面可复用模块**：面包屑本身应复用 `template-parts/components/breadcrumbs.php`，但整个首屏可作为 **Solution 详情专用 hero 模块** 放在 `solution_detail/` |
| Solution 标题 + 发布时间 | `solution-detail-hero.php` | H1 文章标题 + 发布时间（单行 meta） | Section `data-id="cc82e42"` 下：`class="elementor-widget-theme-post-title"` 和 `class="elementor-widget-post-info"` | **页面类型公共模块**（Solution 详情），可与 Blog 详情的 `blog-detail-hero.php` 形成相似结构，但逻辑独立，建议放在 `template-parts/solution_detail/solution-detail-hero.php` |

#### 4. 主内容三列布局 Section（Share / TOC+正文 / 视频+Feature Product）

整个 section：`data-id="04e0370"`，是 Solution 详情的核心内容布局，可拆为 3 个逻辑子区块：

##### 4.1 左侧「Share」竖直分享栏（桌面端）

| 区块 | 建议文件名 | 功能描述 | HTML 标识/锚点 | 重用性评估 |
| --- | --- | --- | --- | --- |
| 左侧 Share 文案 + 图标分享栏 | `solution-detail-sidebar-share.php`（建议） | 在桌面端显示「Share」标题和一列社交分享按钮（Facebook/Twitter/LinkedIn 等），随页面滚动固定 | `data-id="aa709fd"` 内：`<p>Share</p>` + `class="elementor-share-buttons--view-icon"` | 业务上与 Blog 页侧边分享类似，但布局不同。**页面类型模块（Solution 详情）**：可以调用 `components/share-buttons.php` 渲染按钮列表，外层布局封装在 `solution_detail/solution-detail-sidebar-share.php` |

##### 4.2 中间列：目录 TOC + 解决方案正文内容

| 区块 | 建议文件名 | 功能描述 | HTML 标识/锚点 | 重用性评估 |
| --- | --- | --- | --- | --- |
| Table of Contents（目录） | 不在 `solution_detail/`；使用 `components/toc.php` | 自动扫描 H2 生成目录，支持折叠/展开 | `class="elementor-widget-table-of-contents"`，`data-id="a4116d4"` | 已在《模块映射.md》中抽象为 `toc`，Blog 详情模板也复用 `template-parts/components/toc.php`。**全站通用模块**，应移/已移至 `components`，Solution 详情直接 `get_template_part('template-parts/components/toc')` |
| Solution 正文内容区 | `solution-detail-content.php` | 包含整篇长文：What Are..., Key Features, Applications, Pricing, Real-World Success Stories 等所有 `<h2>/<h3>/p/ul/ol/figure>` | `class="elementor-widget-theme-post-content"`，`data-id="d05e399"` | **页面类型模块（Solution 详情）**：只在 Solution 详情中出现，建议在 `template-parts/solution_detail/solution-detail-content.php` 中通过 `the_content()` + 适配类名输出，方便后续多篇 Solution 共享模板 |

##### 4.3 右侧列：视频 + Feature Product 产品列表

| 区块 | 建议文件名 | 功能描述 | HTML 标识/锚点 | 重用性评估 |
| --- | --- | --- | --- | --- |
| Solution 详情右侧视频 | `solution-detail-sidebar-video.php`（可选，或并入 main 模块） | 展示 YouTube 视频（目前指向 `https://youtu.be/pf7nigEzI34`），强化解决方案场景感 | `class="elementor-widget-video"`，`data-id="faebde6"` | **页面类型模块（Solution/Solution 归档共用）**：该视频配置在 `template-parts/solution/layout-two-column-solution.php` 中也出现，可提炼为复用组件，或继续在 Solution 详情中内联 |
| Feature Product 产品列表（右侧） | 不新建；**复用** `template-parts/solution/sidebar-feature-product.php` | 显示 4+1 条精选产品卡片（完全静态 HTML，指向具体 Woo 产品链接） | `class="elementor-element-b95c16a"` / 产品 `<ul class="products elementor-grid columns-2">` | **跨页面可复用模块**：当前 `page-solution-detail.php` 中的产品列表结构，与已存在的 `sidebar-feature-product.php` 基本一致。建议：Solution 详情右侧直接调用 `get_template_part('template-parts/solution/sidebar-feature-product')`，无需在 `solution_detail/` 再建文件 |

#### 5. 上一篇 / 下一篇跳转（Post Navigation）

| 区块 | 建议文件名 | 功能描述 | HTML 标识/锚点 | 重用性评估 |
| --- | --- | --- | --- | --- |
| Solution 详情上一篇/下一篇 | 不在 `solution_detail/`；使用 `components/post-navigation.php` | 显示上一篇 Solution 的标题和链接（当前仅有 “Previous”） | Section `data-id="14ac244"` 内：`class="elementor-widget-post-navigation"`，`data-id="72c9480"` | 已在《模块映射.md》中定义为 `post-navigation`，且在 Blog 详情中使用 `template-parts/components/post-navigation.php`。**全站通用模块**，Solution 详情应直接使用该组件 |

#### 6. Related Solutions 列表区块

| 区块 | 建议文件名 | 功能描述 | HTML 标识/锚点 | 重用性评估 |
| --- | --- | --- | --- | --- |
| Related Solutions 列表 | `solution-detail-related.php` | 标题“Related Solutions”+ 4 条其他解决方案的卡片（标题 + 摘要 +链接，使用 Solution 自定义文章类型） | Section `data-id="48c1715"` 内：`class="elementor-widget-posts"`，`data-id="7d2043d"` | 逻辑上与 Solution 归档的 `loop-solution-grid` 一致，均是 Solution 列表展示。**页面类型公共模块**：可以在 `solution-detail-related.php` 中复用 `loop-solution-grid.php` 的卡片结构，仅调整查询为“当前 Solution 的推荐/相关条目”，属于 Solution 类型通用模块 |

#### 7. 页脚 Footer（CTA + 证书画廊 + 信息四列 + 版权）

| 区块 | 建议文件名 | 功能描述 | HTML 标识/锚点 | 重用性评估 |
| --- | --- | --- | --- | --- |
| 全站 Footer 结构 | 不在 `solution_detail/`；复用 `layout/site-footer.php` | 包含：顶部 CTA「Contact Us To Get The Newest Quotation」、证书图片画廊、四列导航（Category/Company/Services/Contact Info）、底部版权 | `footer[data-elementor-type="footer"][data-elementor-id="442"]`；内部 section `data-id="e477ed7"` 等 | 已被《全站模块分析.md》标记为 `site-footer`。**全站公共模块**：应使用 `site-footer.php` 统一输出，不在 `solution_detail/` 中重复 |
| Footer 顶部 CTA 子块 | 已包含在 `site-footer` 中 | 引导用户联系询价的 CTA 文案 + 按钮 | `data-id="babc870"` 内的 heading + button | 作为 Footer 内部子模块，不单独拆 `solution_detail` 文件；归属 `site-footer` 的结构 |

#### 8. 全站营销弹窗（Catalog Download Popup）

| 区块 | 建议文件名 | 功能描述 | HTML 标识/锚点 | 重用性评估 |
| --- | --- | --- | --- | --- |
| Catalog Download 营销弹窗 | 不在 `solution_detail/`；使用 `components/popup-catalog-download.php` | 全站通用目录下载弹窗，通过页面加载触发 | `div[data-elementor-type="popup"][data-elementor-id="2636"]` | 已在《模块映射.md》中列为 `popup-catalog-download`，**全站公共模块**，推荐在 `footer.php` 中统一 `get_template_part('template-parts/components/popup-catalog-download')`，不在 Solution 详情私有模板中保留一份 |

---

### 二、推荐的 `template-parts/solution_detail/` 文件清单（仅 Solution 详情专用）

结合上表与现有 `template-parts/` 目录结构，**Solution 详情页面真正需要新建 / 维护的模块**建议如下：

- `template-parts/solution_detail/solution-detail-hero.php`  
  - 包含：Solution 面包屑 + H1 标题 + 发布时间 meta  
  - 内部调用：`get_template_part('template-parts/components/breadcrumbs')`

- `template-parts/solution_detail/solution-detail-content.php`  
  - 包含：整篇解决方案正文（调用 `the_content()`），保留 Element0r 导出的主要结构类（方便 CSS 复用）

- `template-parts/solution_detail/solution-detail-sidebar-share.php`（可选）  
  - 包含：左列「Share」文案 + 竖直分享按钮布局  
  - 内部调用：`get_template_part('template-parts/components/share-buttons')` 渲染具体社交按钮

- `template-parts/solution_detail/solution-detail-related.php`  
  - 包含：“Related Solutions” 标题 + 4 条 Solution 卡片  
  - 内部可借鉴 `loop/loop-solution-grid.php` 的卡片结构，仅调整查询逻辑（如基于分类/标签/手动关联）

视频 + Feature Product 右侧栏推荐直接复用：

- 视频部分：  
  - 若多处 Solution 详情共用同一配置，可抽到 `template-parts/solution_detail/solution-detail-sidebar-video.php`；否则可保持在主模板中。

- Feature Product 列表：  
  - 直接复用现有 `template-parts/solution/sidebar-feature-product.php`，无须在 `solution_detail/` 中重复创建。

---

### 三、拆分后的 `page-solution-detail.php` 结构预览

> 目标：结构风格尽量向 `page-solution.php` 和 `page-blog-detail.php` 靠拢，仅负责“模块编排”，具体 HTML 块由 `template-parts/` 输出。

示意结构如下（仅示例调用方式，不是最终实现）：

```php
<?php
/**
 * Template Name: 解决方案详情
 *
 * Migrated from swforming/index-14.html
 */

get_header();
?>

<link rel='stylesheet' id='blocksy-dynamic-global-css' href='<?php echo get_template_directory_uri(); ?>/static/css/global.css' media='all' />
<link rel='stylesheet' id='wp-block-library-css' href='<?php echo get_template_directory_uri(); ?>/static/css/style.min.css' media='all' />
<link rel='stylesheet' id='ct-main-styles-css' href='<?php echo get_template_directory_uri(); ?>/static/css/main.min.css' media='all' />
<link rel='stylesheet' id='ct-woocommerce-styles-css' href='<?php echo get_template_directory_uri(); ?>/static/css/woocommerce.min.css' media='all' />
<link rel='stylesheet' id='ct-elementor-styles-css' href='<?php echo get_template_directory_uri(); ?>/static/css/elementor-frontend.min.css' media='all' />
<link rel='stylesheet' id='ct-elementor-woocommerce-styles-css' href='<?php echo get_template_directory_uri(); ?>/static/css/elementor-woocommerce-frontend.min.css' media='all' />
<link rel='stylesheet' id='widget-heading-css' href='<?php echo get_template_directory_uri(); ?>/static/css/widget-heading.min.css' media='all' />
<link rel='stylesheet' id='widget-table-of-contents-css' href='<?php echo get_template_directory_uri(); ?>/static/css/widget-table-of-contents.min.css' media='all' />
<link rel='stylesheet' id='widget-video-css' href='<?php echo get_template_directory_uri(); ?>/static/css/widget-video.min.css' media='all' />
<link rel='stylesheet' id='widget-woocommerce-products-css' href='<?php echo get_template_directory_uri(); ?>/static/css/widget-woocommerce-products.min.css' media='all' />
<link rel='stylesheet' id='widget-post-navigation-css' href='<?php echo get_template_directory_uri(); ?>/static/css/widget-post-navigation.min.css' media='all' />
<link rel='stylesheet' id='widget-posts-css' href='<?php echo get_template_directory_uri(); ?>/static/css/widget-posts.min.css' media='all' />
<link rel='stylesheet' id='e-popup-css' href='<?php echo get_template_directory_uri(); ?>/static/css/popup.min.css' media='all' />
<link rel='stylesheet' id='elementor-post-5-css' href='<?php echo get_template_directory_uri(); ?>/static/css/post-5.css' media='all' />
<link rel='stylesheet' id='elementor-post-442-css' href='<?php echo get_template_directory_uri(); ?>/static/css/post-442.css' media='all' />
<link rel='stylesheet' id='elementor-post-5183-css' href='<?php echo get_template_directory_uri(); ?>/static/css/post-5183.css' media='all' />
<link rel='stylesheet' id='elementor-post-2636-css' href='<?php echo get_template_directory_uri(); ?>/static/css/post-2636.css' media='all' />

<main id="main" class="site-main hfeed" itemscope="itemscope" itemtype="https://schema.org/CreativeWork">
    <div data-elementor-type="single-post" data-elementor-id="5183" class="elementor elementor-5183 elementor-location-single">
        <?php get_template_part('template-parts/solution_detail/solution-detail', 'hero'); ?>

        <section class="elementor-section elementor-top-section elementor-element elementor-element-04e0370 elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="04e0370" data-element_type="section">
            <div class="elementor-container elementor-column-gap-default">
                <div class="elementor-column elementor-col-33 elementor-top-column elementor-element elementor-element-ca1627d elementor-hidden-mobile" data-id="ca1627d" data-element_type="column">
                    <div class="elementor-widget-wrap elementor-element-populated">
                        <?php get_template_part('template-parts/solution_detail/solution-detail', 'sidebar-share'); ?>
                    </div>
                </div>

                <div class="elementor-column elementor-col-33 elementor-top-column elementor-element elementor-element-401a4a5" data-id="401a4a5" data-element_type="column">
                    <div class="elementor-widget-wrap elementor-element-populated">
                        <?php get_template_part('template-parts/components/toc'); ?>
                        <?php get_template_part('template-parts/solution_detail/solution-detail', 'content'); ?>
                    </div>
                </div>

                <div class="elementor-column elementor-col-33 elementor-top-column elementor-element elementor-element-a92fb9f" data-id="a92fb9f" data-element_type="column">
                    <div class="elementor-widget-wrap elementor-element-populated">
                        <?php
                        get_template_part('template-parts/solution_detail/solution-detail', 'sidebar-video');
                        get_template_part('template-parts/solution/sidebar-feature-product');
                        ?>
                    </div>
                </div>
            </div>
        </section>

        <?php get_template_part('template-parts/components/post-navigation'); ?>
        <?php get_template_part('template-parts/solution_detail/solution-detail', 'related'); ?>
    </div>
</main>

<?php
get_footer();
?>
```

上面的结构实现了：

- **全站通用模块**：Header、Footer、TOC、分享按钮、Post Navigation、Popup 等全部走 `layout/` 和 `components/` 目录；
- **Solution 类型模块**：列表页已经在 `template-parts/solution/` 下（`solution-archive-header`、`layout-two-column-solution` 等）；详情页则由 `template-parts/solution_detail/` 下的若干文件承载；
- **产品列表 Feature Product**：完全复用已有的 `sidebar-feature-product.php`。

---

### 四、拆分实现时的核心注意项

在实际从 `page-solution-detail.php` 中拆分模块到 `template-parts/` 时，建议特别注意：

- **1. 全局 `$post` / 循环上下文**
  - Solution 详情页会依赖当前 Solution 的内容和元数据，推荐遵循 `page-blog-detail.php` 的方式：在主模板中确定 `$elysia_solution_post` 后，设置全局 `$post` 再渲染模板片段。
  - 若 `solution-detail-related.php` 中执行自定义 `WP_Query` 查询相关解决方案，记得在循环结束后调用 `wp_reset_postdata()`，避免污染后续模块（尤其是 Footer 中若有 `the_title()` 等调用）。

- **2. 目录 TOC 与正文内容的配合**
  - `components/toc.php` 默认会针对页面上的 H2/H3 等标签生成目录；`solution-detail-content.php` 中的 HTML 结构应尽量保持原始 Element0r 导出的 heading 层级，避免删改导致目录无法正确生成。
  - 如果后期对内容区做进一步结构化（如拆段落为多个子模板），注意保证 heading 标签仍在同一 DOM 范围内被 TOC 扫描到。

- **3. 共享组件调用的一致性**
  - Share Buttons、TOC、Post Navigation 在 Blog 与 Solution 详情中调用方式尽量统一（均用 `get_template_part('template-parts/components/...')`），这样后续改 UI/逻辑只需改一处。
  - Feature Product 右侧栏同样应只保留一份模板 `sidebar-feature-product.php`，Solution 详情仅负责布局。

- **4. 未来 WooCommerce 动态化的预留**
  - 当前 Feature Product 模块是纯静态 `<li class="product">` 列表，没有用到 `$product` 和 WooCommerce Loop。  
  - 如果未来要改为 **动态从特定产品分类中选取**，建议：
    - 在 `sidebar-feature-product.php` 中执行自定义产品查询；
    - 循环中为每个产品设置全局 `$product`；
    - 按照《模块映射.md》中 `card-product` 的设计，复用 `template-parts/loop/card-product.php` 渲染单个产品卡片。

- **5. 全站 Overlay / Popup 的挂载位置**
  - Overlay（搜索、offcanvas）和 Catalog Popup 都属于全站级模块，应统一在 `header.php` / `footer.php` 或通过 Hook 在 `wp_head` / `wp_footer` 中输出。  
  - 拆分时从 `page-solution-detail.php` 中移除它们的 HTML，并确保 Header 中的触发按钮（`data-toggle-panel="#search-modal"`、`data-toggle-panel="#offcanvas"`）与新组件中的 `id` 保持一致。

- **6. CSS 与 Element0r class 的保留**
  - 当前主题大量依赖 Element0r 导出的类名（如 `elementor-section elementor-element-cc82e42` 等）来匹配已经导出的 CSS 文件（`post-5183.css` 等）。  
  - 在拆分到 `template-parts/solution_detail/` 时，**不要随意更改这些关键类名**，否则会导致现有 CSS 失效；可以只是把 HTML 从 `page-solution-detail.php` 移到对应模板文件中，结构保持不变。

