# 产品列表模块拆分核对报告（archive-product.php）

文件：`wp-content/themes/Elysia_first_web/woocommerce/archive-product.php`

---

## 一、拆分清单表格

> 说明：  
> - 建议文件名均放在 `template-parts/product/` 目录下，命名遵守《模块映射.md》中的语义化风格。  
> - “重用性评估”依据《全站模块分析.md》，并结合该模块是否只在产品归档页出现。  
> - 行尾括号标注源文件位置，格式：`archive-product.php:<line>`。

### 1. 产品归档首屏标题区（Page Hero）

- 起止结构：第一个 `section.elementor-top-section`，背景图 + 大标题 `Product`
- HTML 标识/锚点：  
  - `section.elementor-element-19e423ae`  
  - 内含 `h1.elementor-heading-title` 文本 `Product`  
  - 位置：`archive-product.php:12-25`
- 功能描述：  
  - 产品归档页的首屏 Hero/Title 区块，展示归档标题「Product」，承接面包屑/结果列表。
- 建议文件名：  
  - `template-parts/product/archive-hero-title.php`
- 重用性评估：  
  - 类型归类与 `page-hero-title` 相同（参见《全站模块分析》“内容页首屏标题区 page-hero-title”），属于**跨页面可复用**的“归档标题区”。  
  - 推荐后续抽象为更通用的 `template-parts/components/page-hero-title.php`，本次可先作为产品归档专用模块落位 `template-parts/product/`。

---

### 2. 产品归档简介 + 按钮 + 视频（Intro + CTA + Video）

- 起止结构：第二个 `section.elementor-top-section`，左侧文本 + CONTACT US / Download cataloge 按钮，右侧视频封面
- HTML 标识/锚点：  
  - `section.elementor-element-2f2ea0f9`  
  - 左列 `elementor-element-28690a29` 包含：  
    - 文本 `Our roll forming machine factory has been established...`  
    - 按钮 `CONTACT US`（弹出询盘 Popup）  
    - 按钮 `Download cataloge`（下载 PDF）  
  - 右列 `elementor-element-35d5f375` 内为 `elementor-widget-video`，带封面图和播放按钮  
  - 位置：`archive-product.php:26-82`
- 功能描述：  
  - 对 Sunway 工厂及能力做引导介绍，并提供两个核心 CTA：咨询与下载目录；同时用视频做品牌展示。
- 建议文件名：  
  - `template-parts/product/archive-intro-cta-video.php`
- 重用性评估：  
  - 从 `index-1.html` / 产品归档类型页面来看，该模块是“产品归档页专用的营销首屏二段介绍”，未在其它页面类型中看到一模一样的组合。  
  - 定位为**Woo 产品归档页面私有模块**，暂不抽到 `components/`。

---

### 3. 产品列表栅格（Woo 产品 Loop：卡片 + 结果统计 + 分页）

- 起止结构：第三个 `section.elementor-top-section`，Elementor 的产品归档 Widget 输出
- HTML 标识/锚点：  
  - `section.elementor-element-5e963cbd`  
  - 包含 `div.elementor-widget-wc-archive-products`（`data-widget_type="wc-archive-products.default"`）  
  - Woo 容器：`div.woocommerce.columns-4`  
  - 结果统计：`p.woocommerce-result-count`（结构锚点与《全站模块分析》“woo-archive-result-count”一致）  
  - 产品卡片：`ul.products.elementor-grid.columns-4` 下的多个 `li.product.type-product`  
  - 分页：`nav.ct-pagination` + `.page-numbers`  
  - 位置：`archive-product.php:83-371`
- 功能描述：  
  - 展示产品归档页的主产品列表，包括：  
    - 顶部结果统计（Showing 1–16 of 83 results）  
    - 产品卡片网格（缩略图、标题、按钮）  
    - 底部分页导航（页码 + Next）。
- 建议拆分粒度与文件名（贴合《模块映射.md》规范）：

1. 结果统计区块（页面私有模块）
   - 建议文件名：`template-parts/product/archive-woo-result-count.php`  
   - 对应模块名：`woo-archive-result-count`  
   - 范围：`<p class="woocommerce-result-count ...">...</p>`（`archive-product.php:92-94`）

2. 产品卡片 Loop（跨页面可复用）
   - 建议文件名：`template-parts/loop/card-product.php`  
   - 这里 `archive-product.php` 未来应只保留 `woocommerce_product_loop_start()` / `woocommerce_product_loop_end()` 或一个简单 Loop，而卡片结构交由 `get_template_part('template-parts/loop/card-product')` 负责。  
   - 当前静态 HTML 中，产品卡片示例位置：`archive-product.php:97-348`（多组 `li.product`）

3. 分页区块（跨页面可复用）
   - 建议文件名：`template-parts/components/pagination.php`  
   - 对应模块名：`pagination`  
   - 当前结构位置：`archive-product.php:351-366`

4. 整体容器（产品栅格 Section）
   - 建议文件名：`template-parts/product/archive-product-grid.php`  
   - 功能：  
     - 包住：结果统计 + 产品卡片 Loop + 分页。  
     - 内部通过 `get_template_part('template-parts/product/archive-woo-result-count')`、`get_template_part('template-parts/loop/card-product')`、`get_template_part('template-parts/components/pagination')` 实现组合。

- 重用性评估：  
  - 卡片（`card-product`）和分页（`pagination`）是明确的**跨页面可复用模块**，应放入 `template-parts/loop/` 和 `template-parts/components/`。  
  - 结果统计与整个 Section 布局偏 Woo 产品归档私有，建议保留在 `template-parts/product/` 下。

---

### 4. C Purlin FAQ 模块（EAEL 手风琴 + 右侧图片）

- 起止结构：带灰/白背景的 FAQ 区块，左侧为 9 条折叠问答，右侧为一张机器图片
- HTML 标识/锚点：  
  - `section.elementor-element-da355e7`（左列 FAQ）  
  - 内部 `div.elementor-widget-eael-adv-accordion`，`id="eael-adv-accordion-af5a84c"`  
  - 多个 `.eael-accordion-list`，`data-tab="1" ... "9"`，问题标题从  
    - `What Are The Main Components Of A C Purlin Roll Forming Machine?`  
    - 到 `What factors should I consider when comparing different C Purlin Roll Forming Machine manufacturers?`  
  - 右侧图片列：`div.elementor-element-07edc44` 内的 `img src=".../Light-Gauge-Steel-Roll-Forming-Machine-02.webp"`  
  - 位置：`archive-product.php:374-603`
- 功能描述：  
  - 针对 C Purlin Roll Forming Machine 的专题 FAQ 模块，提供工艺、材料、选择、维护、安全等 9 条问答，右侧配合机器照片，用于 SEO 与转化。
- 建议文件名：  
  - `template-parts/product/archive-c-purlin-faq.php`
- 重用性评估：  
  - FAQ 内容非常针对 C Purlin 产品线，在《全站模块分析》中也没有作为全站 FAQ 通用模块提及；只在产品归档某一类目对应页面出现。  
  - 定位为**Woo 产品归档页面私有模块**，暂不抽象到 `components`。

---

### 5. Our Factory 工厂图库模块

- 起止结构：“Our Factory” 标题 + 三张工厂图片画廊
- HTML 标识/锚点：  
  - `section.elementor-element-3b27951c`  
  - 标题 `h2.elementor-heading-title` 文本 `Our Factory`  
  - 图库 Widget：`div.elementor-element-61bc0b9b.gallery-spacing-custom.elementor-widget-image-gallery`  
  - 内部 `div#gallery-1.gallery-columns-3` 下三张工厂图片  
  - 位置：`archive-product.php:604-645`
- 功能描述：  
  - 展示工厂实景三张图片，用于体现生产能力与可信度。
- 建议文件名：  
  - `template-parts/product/archive-factory-gallery.php`
- 重用性评估：  
  - 该模块的内容和 `index-2.html`（Electric & Energy 分类页）、`index-6.html`（Factory 页面）存在相似结构，但图片和文案常与具体页面类型绑定。  
  - 目前可以作为**Woo 产品归档页面私有模块**处理；若后续确认多个页面真正复用同一图库结构，可以再升格为 `template-parts/components/factory-gallery.php`。

---

### 6. Why Sunway + The Global Leader In Roll forming Industry 模块

- 起止结构：左侧 Why Sunway 标题 + 大段介绍文字 + Checklist 列表；右侧两个数据 Icon Box（100+ countries / 500+ projects）
- HTML 标识/锚点：  
  - `section.elementor-element-79b255e0`  
  - 小标题 `h5` 文本：`Why Sunway`  
  - 主标题 `h2` 文本：`The Global Leader In Roll forming Industry`  
  - 中间一列 `icon-list`：多条 `We Use Advance Manufacturing Process` / `Provide Unique Technology` / `Group Of Certified & Experienced Team` / `The Best Services For Multiple Industries`  
  - 右侧 Icon Box：`100+ Destination Countries`、`500+ Finished Project`  
  - 位置：`archive-product.php:646-760`
- 功能描述：  
  - 全站层面的品牌背书模块，用 Bullet 列表和关键数字强化 Sunway 的全球影响力与经验。
- 建议文件名：  
  - 若按“产品归档页面私有模块”处理：  
    - `template-parts/product/archive-why-sunway.php`  
  - 若考虑全站复用（更推荐的长期做法）：  
    - `template-parts/components/section-why-sunway-global-leader.php`（或更简化：`why-sunway-global-leader.php`）
- 重用性评估：  
  - `index-1.html` 产品列表、`index-5.html` Why Us、以及其它页面中都存在类似「Why Sunway + 数字」模块，是明显的**跨页面可复用品牌模块**。  
  - 结合《全站模块分析》中关于“首页内容区块”与“普通单页模块”的描述，此块更接近“跨页面品牌组件”，建议**抽象到 `components/` 目录**，然后产品归档通过 `get_template_part('template-parts/components/section-why-sunway-global-leader')` 调用。

---

### 7. 侧栏品牌图 / 公司照片模块

- 起止结构：在 “Why Sunway” 模块右侧的单张品牌图片
- HTML 标识/锚点：  
  - 同属于 `section.elementor-element-79b255e0` 的右侧列：`div.elementor-element-8e36f27`  
  - 内部图片：`img src="<?php echo get_template_directory_uri(); ?>/static/image/sunway.jpg"`  
  - 位置：`archive-product.php:775-782`
- 功能描述：  
  - 展示 Sunway 品牌图片（Logo + 工厂/设备），作为品牌强化和视觉平衡。
- 建议文件名：  
  - 若保持和 “Why Sunway” 一体，可以将其视为上一模块内部的一部分，不单独拆文件。  
  - 若单独模块化：`template-parts/components/brand-photo-sunway.php`（仅在多页面复用时有意义）。
- 重用性评估：  
  - 内容高度品牌通用，有潜力作为全站 Brand Photo 组件。  
  - 初期可以先视为 “Why Sunway” 模块的一部分，不强制拆出独立文件。

---

### 8. Contact Us Now 收尾 CTA Section

- 起止结构：页面底部的整宽 CTA 区（背景色 + 标题「Contact Us Now」）
- HTML 标识/锚点：  
  - `section.elementor-element-458bf90b`  
  - 内部 `h2.elementor-heading-title` 文本：`Contact Us Now`  
  - 位置：`archive-product.php:786-799`
- 功能描述：  
  - 整页收尾 CTA，鼓励用户进行联系（对应上方按钮弹出的 Inquiry Popup）。在结构上通常会挂载一个按钮或配合全站 `popup-product-inquiry` / `popup-catalog-download`。
- 建议文件名：  
  - `template-parts/product/archive-contact-us-cta.php`
- 重用性评估：  
  - 虽然「Contact Us Now」文案全站多次出现，但每个页面的布局/背景/按钮行为略有不同。  
  - 当前可作为**产品归档页面私有 CTA**，后续视情况抽象为 `template-parts/components/contact-cta.php`。

---

## 二、拆分后的 `archive-product.php` 结构预览

> 目标：主模板只做“编排”，实际结构由 `template-parts/` 模块输出。  
> 下面是一个示例结构（示意，不包含具体参数与判断逻辑）：

```php
<?php

/**
 * Template Name:产品列表
 *
 */
get_header();
?>

<main id="main" class="site-main hfeed" itemscope="itemscope" itemtype="https://schema.org/CreativeWork">
    <div data-elementor-type="product-archive" data-elementor-id="1206" class="elementor elementor-1206 elementor-location-archive product" data-elementor-post-type="elementor_library">
        <?php
        get_template_part('template-parts/product/archive', 'hero-title');
        get_template_part('template-parts/product/archive', 'intro-cta-video');
        get_template_part('template-parts/product/archive', 'product-grid');
        get_template_part('template-parts/product/archive', 'c-purlin-faq');
        get_template_part('template-parts/product/archive', 'factory-gallery');
        get_template_part('template-parts/product/archive', 'why-sunway');
        get_template_part('template-parts/product/archive', 'contact-us-cta');
        ?>
    </div>
</main>

<?php
get_footer();
```

> 若进一步结合《模块映射.md》中对 Woo 归档页面的推荐组合（`breadcrumbs` + `woo-archive-result-count` + `card-product` + `pagination` + `popup-product-inquiry`），未来可以在该模板头部增加：

```php
// 面包屑（可选）
get_template_part('template-parts/components/breadcrumbs');

// 全局询盘弹窗（popup-product-inquiry）
// 一般放在 footer 或通过 Hook 输出，这里仅示意
// get_template_part('template-parts/components/popup-product-inquiry');
```

---

## 三、拆分过程中的核心注意项

### 1. WooCommerce 全局变量与 Loop 环境

- `card-product` 模块在真正接入 Woo 查询 Loop 时，应依赖标准 WooCommerce Loop 变量：
  - `$product`（当前产品对象）
  - `global $woocommerce_loop;`
- 拆分时建议：
  - 在 `archive-product.php` 或 Hook 中使用标准 Woo Loop：  
    `woocommerce_product_loop_start()` / `woocommerce_product_loop_end()` 或 `wc_get_template_part( 'content', 'product' )`。  
  - 或在自定义 Loop 内手动 `global $product;`，并在 `template-parts/loop/card-product.php` 内使用 `$product` 输出标题、价格、链接等。
- 避免在模块中直接写死产品链接或图片路径，后续需从 `$product` 动态读取。

### 2. WooCommerce / Elementor Hooks

- 若后续把 `woo-archive-result-count`、`pagination`、`card-product` 等通过 Hook 输出，而不是在 `archive-product.php` 中直接 `get_template_part`，注意：
  - `woocommerce_before_shop_loop`：可挂载结果统计模块；
  - `woocommerce_after_shop_loop`：可挂载分页；
  - `woocommerce_before_shop_loop_item_title` / `woocommerce_after_shop_loop_item`：可用于替换产品卡片结构（需要在 `functions.php` 中 `remove_action` 默认输出）。
- 当前阶段先做模板级拆分即可，只要保证模块内部不调用 `get_header()` / `get_footer()`、不破坏 Loop 环境。

### 3. 全局弹窗与 CTA 触发关系

- 页面中多处按钮通过 URL 触发 Elementor Popup，如：
  - `href="#elementor-action:action=popup:open&settings=eyJpZCI6IjM0MyIsInRvZ2dsZSI6ZmFsc2V9"`（产品询盘）  
  - `href="#elementor-action:action=popup:open&settings=eyJpZCI6IjMwNiIsInRvZ2dsZSI6ZmFsc2V9"`（联系弹窗）
- 拆分模块时：
  - 保留这些 `href` 字符串，不要改动 popup ID，避免影响既有弹窗逻辑。  
  - 注意这些 CTA 所依赖的弹窗结构（`popup-catalog-download` / `popup-product-inquiry`）是全站级组件，按《模块映射》应由 `footer.php` 或 Hook 统一输出。

### 4. 样式与脚本的依赖

- 本页面多个模块依赖以下样式/脚本（已在 `header.php` / `footer.php` 中挂载）：
  - Elementor 前端样式：`elementor-frontend.min.css`、`post-1206.css`
  - EAEL Accordion 样式与脚本：`eael-1206.css`、`eael-1206.js`
  - 图库样式：`widget-image-gallery.min.css`
- 在模块拆分时：
  - 不要在模块文件里重复引入 CSS / JS。  
  - 保证 `header.php` / `footer.php` 的 enqueue 逻辑不被破坏。

### 5. PHP 开头/结尾与上下文

- 每个 `template-parts/product/*.php` 文件：
  - 不应调用 `get_header()` / `get_footer()`；  
  - 不应开启新的 `<main>` 或 `<body>` 标签，仅输出对应 Section 的 HTML。  
  - 默认在与 `archive-product.php` 相同的环境下执行，可直接写 HTML + 少量 `<?php echo get_template_directory_uri(); ?>` 等调用。
