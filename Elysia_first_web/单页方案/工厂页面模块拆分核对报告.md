# 工厂页面模块拆分核对报告（page-factory.php）

模板文件：`e:\phpstudy_pro\WWW\wp-content\themes\Elysia_first_web\page-factory.php`  
页面来源：`index-6.html`（Factory，single_page 类型）

---

## 一、拆分清单表格

> 仅针对 `<main>` 内 Elementor 页面结构进行模块拆分；`popup` 弹窗属于全站级营销弹窗 / 询盘弹窗，依据《模块映射.md》应抽到 `components`，在本表中单独标注。

| 序号 | 建议文件名                                                  | 功能描述                                                                                                  | HTML 标识 / 锚点（起始特征）                                                                                                                                       | 重用性评估 |
|------|-------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------|
| 1    | `template-parts/components/page-hero-title.php`            | 工厂页首屏标题区：展示 H1 “Our Factory”，统一普通单页的 Hero 标题区样式/高度/背景。                       | `section.elementor-top-section.elementor-element-37db29b` 内含 `h1.elementor-heading-title` 文案 “Our Factory”                                                                                            | 全站通用（复用 `page-hero-title` 组件，按页面标题动态输出） |
| 2    | `template-parts/one_page/factory-intro.php`                | 工厂介绍区块：左侧“quality manufacturing” 副标题 + “The Leading Roll forming machine Factory In China” 主标题 + 两段工厂介绍文案 + CONTACT US 按钮；右侧工厂大图。 | `section.elementor-top-section.elementor-element-8ad7d98`，左右两列：左列 `elementor-element-ea58ef3` 包含文案和按钮 `elementor-element-cfe889e`；右列 `elementor-element-8e18fd6` 包含图片 `362523446.jpg` | 页面私有（文案/结构与工厂主题强绑定，如后续有类似版式可再抽象） |
| 3    | `template-parts/one_page/factory-gallery.php`              | 工厂相册区：标题 “GALLERY / Take A Look At Our Factory” + 4 列 WordPress gallery 展示工厂图片。           | `section.elementor-top-section.elementor-element-3f7bc04` 内包含 `h5` 文案 “GALLERY”、`h2` 文案 “Take A Look At Our Factory”，以及 `div.elementor-image-gallery` 下的 `div.gallery.galleryid-214` 图片列表 | 页面私有（图片与工厂页专属，结构可复用，但数据固定） |
| 4    | `template-parts/one_page/factory-details-intro.php`        | 工厂细节标题区：背景覆盖 + 标题 “SOME DETAILS OF OUR FACTORY / You are welcome to visit us in China”。   | `section.elementor-top-section.elementor-element-dfe3648`，含 `.elementor-background-overlay` 与两个 heading：`data-id="6a1e50a"`、`data-id="6edaa29"`                                                   | 页面私有（与下方细节卡片组合构成完整内容区） |
| 5    | `template-parts/one_page/factory-details-grid.php`         | 工厂细节三列说明卡片：Lean Production Line / Manufacturing Team / Equipment Warehouse，每列图文介绍。     | `section.elementor-top-section.elementor-element-ab2c0d6`，3 列 `.elementor-col-33`，内部为 `elementor-widget-image-box`（`04335d8`、`8a9f8b9`、`3e6fb64`） 各自包含图片 + `elementor-image-box-content` | 页面私有（工厂页面专属卖点说明） |
| 6    | `template-parts/components/popup-product-inquiry.php`      | 工厂页内“Get in touch with sunway” 询盘弹窗（Elementor Popup ID 306），承载联系表单 iframe。              | 页面末尾第一个 popup：`div[data-elementor-type="popup"][data-elementor-id="306"]`，内部标题 “Get in touch with sunway”，iframe `SunwayContactForm`                                                        | 全站通用型“产品/类目/通用询盘弹窗”，应与其它页面共用，抽到 components（参考《全站模块分析》18） |
| 7    | `template-parts/components/popup-catalog-download.php`     | 全站营销弹窗：Catalog 下载表单（Elementor Popup ID 2636），带触发策略（30 秒弹出、仅一次）。              | 第二个 popup：`div[data-elementor-type="popup"][data-elementor-id="2636"]`，标题 “Latest Price & Catalog”，iframe `SunwayCatalogDownloadContactForm`；与《全站模块分析》4) 完全一致                     | 全站通用（已在《模块映射.md》中指定为 `components/popup-catalog-download.php`） |

---

## 二、拆分后 page-factory.php 结构预览

下面示例展示拆分后的主模板如何通过 `get_template_part()` 调用各模块。示例中仅重点演示 `<main>` 内的模块调用关系，CSS/JS 引入保持不变。

```php
<?php
/**
 * Template Name: 工厂页面
 * 工厂页面模板（从 swforming/index-6.html 迁移）
 */

get_header();
?>

<link rel='stylesheet' id='blocksy-dynamic-global-css' href='<?php echo get_template_directory_uri(); ?>/static/css/global.css' media='all' />
<link rel='stylesheet' id='wp-block-library-css' href='<?php echo get_template_directory_uri(); ?>/static/css/style.min.css' media='all' />
<style id='wp-img-auto-sizes-contain-inline-css'>
    img:is([sizes=auto i], [sizes^="auto," i]) {
        contain-intrinsic-size: 3000px 1500px
    }
</style>
<style id='global-styles-inline-css'>
    :root {
        --wp--preset--aspect-ratio--square: 1;
        --wp--preset--aspect-ratio--4-3: 4/3;
        --wp--preset--aspect-ratio--3-4: 3/4;
        --wp--preset--aspect-ratio--3-2: 3/2;
        --wp--preset--aspect-ratio--2-3: 2/3;
        --wp--preset--aspect-ratio--16-9: 16/9;
    }
</style>
<link rel='stylesheet' id='woocommerce-inline-inline-css' href='<?php echo get_template_directory_uri(); ?>/static/css/woocommerce-inline.css' media='all' />
<link rel='stylesheet' id='trp-language-switcher-style-css' href='<?php echo get_template_directory_uri(); ?>/static/css/trp-language-switcher.css' media='all' />
<link rel='stylesheet' id='brands-styles-css' href='<?php echo get_template_directory_uri(); ?>/static/css/brands.css' media='all' />
<link rel='stylesheet' id='parent-style-css' href='<?php echo get_template_directory_uri(); ?>/static/css/style.css' media='all' />
<link rel='stylesheet' id='ct-main-styles-css' href='<?php echo get_template_directory_uri(); ?>/static/css/main.min.css' media='all' />
<link rel='stylesheet' id='ct-woocommerce-styles-css' href='<?php echo get_template_directory_uri(); ?>/static/css/woocommerce.min.css' media='all' />
<link rel='stylesheet' id='ct-elementor-styles-css' href='<?php echo get_template_directory_uri(); ?>/static/css/elementor-frontend.min.css' media='all' />
<link rel='stylesheet' id='ct-elementor-woocommerce-styles-css' href='<?php echo get_template_directory_uri(); ?>/static/css/elementor-woocommerce-frontend.min.css' media='all' />
<link rel='stylesheet' id='elementor-frontend-css' href='<?php echo get_template_directory_uri(); ?>/static/css/frontend.min.css' media='all' />
<link rel='stylesheet' id='e-animation-fadeInUp-css' href='<?php echo get_template_directory_uri(); ?>/static/css/fadeInUp.min.css' media='all' />
<link rel='stylesheet' id='e-animation-fadeIn-css' href='<?php echo get_template_directory_uri(); ?>/static/css/fadeIn.min.css' media='all' />
<link rel='stylesheet' id='widget-divider-css' href='<?php echo get_template_directory_uri(); ?>/static/css/widget-divider.min.css' media='all' />
<link rel='stylesheet' id='eael-general-css' href='<?php echo get_template_directory_uri(); ?>/static/css/general.min.css' media='all' />

<script src="<?php echo get_template_directory_uri(); ?>/static/js/jquery.min.js" id="jquery-core-js"></script>
<script src="<?php echo get_template_directory_uri(); ?>/static/js/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script src="<?php echo get_template_directory_uri(); ?>/static/js/jquery.blockUI.min.js" id="wc-jquery-blockui-js" defer data-wp-strategy="defer"></script>
<script src="<?php echo get_template_directory_uri(); ?>/static/js/add-to-cart.min.js" id="wc-add-to-cart-js" defer data-wp-strategy="defer"></script>
<script src="<?php echo get_template_directory_uri(); ?>/static/js/js.cookie.min.js" id="wc-js-cookie-js" defer data-wp-strategy="defer"></script>
<script src="<?php echo get_template_directory_uri(); ?>/static/js/woocommerce.min.js" id="woocommerce-js" defer data-wp-strategy="defer"></script>
<script src="<?php echo get_template_directory_uri(); ?>/static/js/trp-frontend-compatibility.js" id="trp-frontend-compatibility-js"></script>

<main id="main" class="site-main hfeed">
    <div class="ct-container-full" data-content="normal">
        <article id="post-214" <?php post_class('page-factory'); ?>>
            <div class="blocksy-woo-messages-default woocommerce-notices-wrapper">
                <div class="woocommerce"></div>
            </div>

            <div class="entry-content is-layout-constrained">
                <div class="elementor elementor-214" data-elementor-type="wp-page" data-elementor-id="214" data-elementor-post-type="page">
                    <?php
                    get_template_part('template-parts/components/page-hero-title');
                    get_template_part('template-parts/one_page/factory-intro');
                    get_template_part('template-parts/one_page/factory-gallery');
                    get_template_part('template-parts/one_page/factory-details-intro');
                    get_template_part('template-parts/one_page/factory-details-grid');
                    ?>
                </div>
            </div>
        </article>
    </div>
</main>

<?php
get_footer();
```

---

## 三、核心注意项（变量 / Hook / 样式交互）

- 全局变量 / WooCommerce  
  当前 `page-factory.php` 未使用 `global $product` 或 WooCommerce Loop，仅有 Woo 脚本/样式引入与一个空的 `.woocommerce` 容器。模块拆分对 Woo 逻辑影响极小。

- Elementor / 动画与样式保留  
  模块拆分到 `template-parts/one_page/*.php` 时，需要原样保留各 `section`、`column`、`widget` 的 DOM 结构、`data-id`、`data-element_type`、`data-settings` 以及动画 class（如 `fadeInUp`、`fadeIn`），以确保现有 CSS/JS 行为不变。

- CONTACT US 按钮行为  
  `factory-intro` 区块中的按钮通过特殊 href 调用 Elementor Popup ID 306，不应改为普通 URL；将 popup HTML 抽到组件文件时，务必保留 `data-elementor-id="306"` 和内部结构。

- 弹窗模块全站联动  
  - Catalog 弹窗（ID 2636）是全站营销弹窗，应迁移到 `template-parts/components/popup-catalog-download.php`，并由 `footer.php` 统一挂载。  
  - 联系弹窗（ID 306）可抽象为 `template-parts/components/popup-product-inquiry.php`，在需要询盘的页面统一调用。

- 与其他 single_page 页的一致性  
  工厂页属于普通单页（single_page），建议与 About / Why Us / Social Responsibility / Quality Manufacturing / Project / FAQ / Contact 等页面统一使用 `page-hero-title` 组件输出首屏标题区，提高全站一致性和维护性。

