# 质量制造页面动态化方案（基于 ACF 与 WordPress 原生能力）

## 一、目标与原则

- 保持“质量制造（Quality Manufacturing）”页面现有样式、布局和动效完全不变，仅将静态内容替换为 ACF 驱动的动态数据  
- 只使用 ACF 插件和 WordPress 原生能力（Page、Options、媒体库等），不引入任何其他插件  
- 充分复用已有通用组件（page-hero-title、shared-contact-popup、全局 CTA 配置等），减少重复维护  
- 采用「全局默认 + 页面级覆盖」两层字段结构，支持多语言、多站点和后续扩展  
- 预留与其他页面（关于我们、工厂、项目案例、FAQ、联系页面等）的联动能力

---

## 二、涉及模板与模块梳理

### 2.1 页面与主模板

- 页面模板：`[page-quality-manufacturing.php](file:///e:/phpstudy_pro/WWW/wp-content/themes/Elysia_first_web/page-quality-manufacturing.php)`  
- 页面来源：`index-8.html`（Quality Manufacturing）

主模板主要职责：

- 保留 CSS / JS / 字体 / WooCommerce / TRP 等引入  
- 保留 `<main>` / `<article>` / `.entry-content` / `.elementor` 骨架结构  
- 调用以下模块：

```php
get_template_part('template-parts/one_page/quality-manufacturing-hero');
get_template_part('template-parts/one_page/quality-manufacturing-intro');
get_template_part('template-parts/one_page/quality-manufacturing-worth-invest');
get_template_part('template-parts/one_page/quality-manufacturing-supply-chain');
get_template_part('template-parts/one_page/shared-contact-popup');
```

### 2.2 质量制造页面相关模块

1. `quality-manufacturing-hero.php`  
   - 功能：首屏 Hero 区域，仅包含标题 “Quality Manufacturing” 和背景 Overlay  
   - 结构：单个 `section.elementor-top-section`，内部 `h1.elementor-heading-title`  
   - 特征：与全站 `page-hero-title` 模式高度一致，属于“内容页首屏标题区”类型

2. `quality-manufacturing-intro.php`  
   - 功能：质量制造介绍 + CTA  
     - 左侧：  
       - 小标题：`SATISFY Manufacturing`  
       - 主标题：`Sunway, Expert In cold roll forming machine Manufacturing`  
       - 段落介绍  
       - CONTACT US 按钮（触发弹窗 ID=306）  
     - 右侧：大图 `Quality Manufacturing 1`（静态图片）

3. `quality-manufacturing-worth-invest.php`  
   - 功能：价值主张模块  
     - 标题区：`WORTHY INVEST` + `The Production Of Sunway / Your Next Worth Ordering`  
     - 下方：3 列价值卡片（每列包含 Icon SVG + 标题 + 描述）  
       - High Standard  
       - Ensure Quality  
       - World-Class  

4. `quality-manufacturing-supply-chain.php`  
   - 功能：供应链与一站式解决方案模块  
     - 标题：`Supply Chain Details` + `We Always Ready To Be Your Partner`  
     - 段落 01：左图右文 “We Always Ready”  
     - 段落 02：右图左文 “One-Stop Solution”

5. `shared-contact-popup.php`  
   - 功能：共享联系弹窗（Elementor Popup ID 306）  
   - 被多个单页（工厂、Why Us、质量制造等）复用

---

## 三、整体动态化设计思路

### 3.1 字段分层：全局默认 + 页面级覆盖

1. 全局层（Options Page）

- 新增/扩展 Options 页面字段组「质量制造全局设置」，存储：
  - 质量制造页面引用（供其他页面跳转使用）  
  - Hero 区默认标题/副标题（也可统一在全站 Hero 配置中管理）  
  - 质量制造介绍模块默认文案与图片  
  - WORTHY INVEST 模块默认标题与三列卡片内容  
  - Supply Chain 模块默认标题、两段编号标题与正文、左右图片

2. 页面层（Quality Manufacturing 页面）

- 新建字段组「质量制造页面设置」，挂在当前页面上，用于：
  - 覆盖全局默认的标题、文案、图片  
  - 控制是否启用特定模块（如将来新增开关）  

获取逻辑：  
**页面级字段优先，若为空则回退到 Options 全局字段，再为空时回退到当前静态硬编码内容**。  
这样改造过程可渐进，不必一次填完所有字段。

### 3.2 模块级复用策略

- Hero 区：  
  - 建议未来统一使用 `components/page-hero-title.php` 通用组件；  
  - 在字段层面使用同一套 Hero 字段（`hero_title` / `hero_subtitle` / 背景图）支持 About / Why Us / Factory / Quality / FAQ / Contact 等所有内容页。

- 联系弹窗按钮：  
  - 继续依赖 `shared-contact-popup.php` + 弹窗 ID=306；  
  - CONTACT US 按钮文本与弹窗 ID 建议由全局 Options 统一管理（在工厂/关于我们方案中已规划全局 CTA/弹窗字段），本页只读不改。

- 价值卡片与图文段落结构：  
  - `quality-manufacturing-worth-invest` 与 `quality-manufacturing-supply-chain` 都属于“标题 + 若干图文块”的标准结构；  
  - 此次方案中暂作为质量制造页面私有模块；  
  - 字段设计上尽量通用（使用 Repeater），以便未来在其他页面复用此版式。

### 3.3 与其他页面的联动

1. Quality Manufacturing 页面引用  
   - 在 Options 中维护 `quality_page_ref`（Post Object），其他页面如果需要引导用户查看更多质量制造信息时，通过该字段生成链接。

2. 与工厂 / 项目案例的联动  
   - 在供应链模块文案中可参考/复用工厂页面的仓储、供应链描述字段；  
   - 后续可通过关系字段将质量制造页与部分项目案例关联（如展示某些“高质量项目案例”链接）。

3. 与 FAQ / Contact 的联动  
   - 通过既有的 `faq_page_ref` 和 Contact 引用字段，在质量制造页增加“查看常见问题”或“联系我们”链接/按钮，形成闭环。

---

## 四、ACF 字段设计（全局 Options）

在 ACF Options Page（如「网站全局设置」）下新增字段组「质量制造全局设置」。

### 4.1 字段组：质量制造全局设置（global_quality_settings）

位置：Options Page（`theme-general-settings` 等）

字段建议：

1. 质量制造页面引用
   - 字段名：`quality_page_ref`  
   - 类型：Post Object（限制为 Page）  
   - 用途：供其他页面生成“Quality Manufacturing”页面链接

2. 默认 Hero 标题（可选）
   - 如果全站 Hero 已有统一字段组，可不在此重复定义，直接使用 `hero_title` 全局字段；  
   - 如需专用字段：
     - 字段名：`quality_hero_title_default`（Text）  
     - 默认值：`Quality Manufacturing`

3. 默认质量制造介绍模块（intro）字段

- Intro 小标题默认值
  - 字段名：`quality_intro_badge_default`  
  - 类型：Text  
  - 默认：`SATISFY Manufacturing`

- Intro 主标题默认值
  - 字段名：`quality_intro_title_default`  
  - 类型：Text  
  - 默认：`Sunway, Expert In cold roll forming machine Manufacturing`

- Intro 正文默认值
  - 字段名：`quality_intro_text_default`  
  - 类型：Textarea / Wysiwyg

- Intro 配图默认
  - 字段名：`quality_intro_image_default`  
  - 类型：Image  
  - 替代当前 `Quality Manufacturing 1` 静态图片

> CONTACT US 按钮文案和弹窗 ID 建议继续使用在工厂/关于我们方案中定义的全局 CTA/弹窗字段（例如 `global_contact_button_text` / `global_contact_popup_id`），此处不再重复定义。

4. 默认 WORTHY INVEST 模块字段

- 标题区默认值：
  - `quality_worth_badge_default`（Text）  
    - 默认：`WORTHY INVEST`
  - `quality_worth_title_default`（Text / Textarea）  
    - 默认：`The Production Of Sunway Your Next Worth Ordering`

- 三列价值卡片列表：
  - 字段名：`quality_worth_cards_default`  
  - 类型：Repeater  
  - 子字段：
    - `icon_svg`（Textarea，存放 SVG 字符串，或使用 Icon 选择字段）  
    - `title`（Text）：如 `High Standard` / `Ensure Quality` / `World-Class`  
    - `description`（Textarea/Wysiwyg）：对应当前段落说明  

5. 默认 Supply Chain 模块字段

- 标题区默认值：
  - `quality_supply_badge_default`（Text）  
    - 默认：`Supply Chain Details`
  - `quality_supply_title_default`（Text）  
    - 默认：`We Always Ready To Be Your Partner`

- 段落 01（We Always Ready）：
  - `quality_supply_1_order_default`（Text）  
    - 默认：`01.`  
  - `quality_supply_1_title_default`（Text）  
    - 默认：`We Always Ready`
  - `quality_supply_1_text_default`（Wysiwyg）  
    - 包含两段描述  
  - `quality_supply_1_image_default`（Image）  
    - 替代当前 `Quality Manufacturing 2` 图片

- 段落 02（One-Stop Solution）：
  - `quality_supply_2_order_default`（Text）  
    - 默认：`02.`  
  - `quality_supply_2_title_default`（Text）  
    - 默认：`One-Stop Solution`
  - `quality_supply_2_text_default`（Wysiwyg）  
  - `quality_supply_2_image_default`（Image）  
    - 替代当前 `Quality Manufacturing 3` 图片

---

## 五、ACF 字段设计（质量制造页面字段组）

在 Quality Manufacturing 页面（使用 `page-quality-manufacturing.php` 模板的页面）上添加字段组「质量制造页面设置」。

### 5.1 字段组：质量制造页面设置（quality_page_settings）

位置规则：

- Post Type = Page  
- 且 Page Template = 质量制造（或 Page = 对应 ID 248）

字段建议：

1. Hero 覆盖字段（复用通用 Hero）

- 推荐直接使用全站通用 Hero 字段组 `Page Hero 通用配置` 中的字段（`hero_title` / `hero_subtitle` / `hero_background_image`），本字段组不重复定义。  
- 如需额外补充标签，可增加：
  - `quality_hero_badge`（Text，可选）用于标题下的小说明。

2. 质量制造介绍模块覆盖

- Intro 小标题：
  - 字段名：`quality_intro_badge`（Text）  
  - 为空则使用 `quality_intro_badge_default`

- Intro 主标题：
  - 字段名：`quality_intro_title`（Text）  
  - 为空则使用 `quality_intro_title_default`

- Intro 正文：
  - 字段名：`quality_intro_text`（Textarea/Wysiwyg）  
  - 为空则使用 `quality_intro_text_default`

- Intro 配图：
  - 字段名：`quality_intro_image`（Image）  
  - 为空则使用 `quality_intro_image_default`

3. WORTHY INVEST 模块覆盖

- 标题区：
  - `quality_worth_badge`（Text） → 为空使用 `quality_worth_badge_default`  
  - `quality_worth_title`（Text / Textarea） → 为空使用 `quality_worth_title_default`

- 价值卡片列表：
  - 字段名：`quality_worth_cards`（Repeater）  
  - 子字段结构同全局 `quality_worth_cards_default`（icon_svg / title / description）  
  - 使用顺序：
    1. 若页面级 `quality_worth_cards` 有内容则使用  
    2. 否则使用全局 `quality_worth_cards_default`

4. Supply Chain 模块覆盖

- 标题区：
  - `quality_supply_badge`（Text） → 为空使用 `quality_supply_badge_default`  
  - `quality_supply_title`（Text） → 为空使用 `quality_supply_title_default`

- 段落 01：
  - `quality_supply_1_order`（Text）  
  - `quality_supply_1_title`（Text）  
  - `quality_supply_1_text`（Wysiwyg）  
  - `quality_supply_1_image`（Image）  
  - 均为空时回退到对应 `_default` 字段

- 段落 02：
  - `quality_supply_2_order`（Text）  
  - `quality_supply_2_title`（Text）  
  - `quality_supply_2_text`（Wysiwyg）  
  - `quality_supply_2_image`（Image）  
  - 同样为空则回退到 `_default`

5. 与其他页面的关联（可选）

- `quality_related_pages`（Relationship / Post Object 多选，限制为 Page）  
  - 用途：在质量制造页面底部增加相关链接（例如：Factory / Project / About / FAQ）

---

## 六、各模块实现要点（逻辑层面）

以下为推荐实现方向，实际代码需在对应模板文件中写入，并保证不破坏现有 HTML 结构、class、data 属性和动画配置。

### 6.1 Hero 区：quality-manufacturing-hero.php

**推荐方案**：用 `page-hero-title` 通用组件替代当前 hero 片段。  
若暂时保留 `quality-manufacturing-hero.php`，也建议内部读取 Hero 通用字段：

```php
$hero_title = get_field('hero_title');
if (!$hero_title) {
    $hero_title = get_field('quality_hero_title_default', 'option')
        ?: get_the_title();
}
```

然后把 `<h1>` 中硬编码的 `Quality Manufacturing` 替换为 `$hero_title`。  
其他背景样式和 Overlay 结构保持不变。

### 6.2 Intro 模块：quality-manufacturing-intro.php

1. 文案数据读取

```php
$badge = get_field('quality_intro_badge');
if (!$badge) {
    $badge = get_field('quality_intro_badge_default', 'option');
}

$title = get_field('quality_intro_title');
if (!$title) {
    $title = get_field('quality_intro_title_default', 'option');
}

$text = get_field('quality_intro_text');
if (!$text) {
    $text = get_field('quality_intro_text_default', 'option');
}
```

2. 图片数据读取

```php
$image = get_field('quality_intro_image');
if (!$image) {
    $image = get_field('quality_intro_image_default', 'option');
}
```

图片输出可以用 `wp_get_attachment_image($image, 'large')` 替代当前硬编码 `img` 标签，并尽量保留现有 class（如 `attachment-large size-large` 等）。

3. 联系按钮

按钮结构：

```html
<a class="elementor-button elementor-button-link elementor-size-md"
   href="#elementor-action%3Aaction%3Dpopup%3Aopen%26settings%3DeyJpZCI6IjMwNiIsInRvZ2dsZSI6ZmFsc2V9">
    <span class="elementor-button-text">CONTACT US</span>
</a>
```

建议：

- 按钮文字：使用全局 CTA 文案字段（例如 `global_contact_button_text`），参考工厂/关于我们方案；  
- 弹窗 ID：使用全局 `global_contact_popup_id` 字段构造 href 字符串，保持与 ID=306 一致；  
- 保留 `href` 中 `#elementor-action:action=popup:open&settings=...` 格式，只替换其中的 ID 值和文案。

示例（逻辑示意）：

```php
$btn_text = get_field('global_contact_button_text', 'option') ?: 'CONTACT US';
$popup_id = get_field('global_contact_popup_id', 'option') ?: 306;
```

然后按现有格式拼接 href。

### 6.3 WORTHY INVEST 模块：quality-manufacturing-worth-invest.php

1. 标题区

```php
$badge = get_field('quality_worth_badge');
if (!$badge) {
    $badge = get_field('quality_worth_badge_default', 'option');
}

$title = get_field('quality_worth_title');
if (!$title) {
    $title = get_field('quality_worth_title_default', 'option');
}
```

将 `<h5>` 和 `<h2>` 内文本替换为上述变量。  
保持 `<br>` 换行等 HTML 结构不变。

2. 三列价值卡片

不建议继续在模板中写死三列的内容，而是使用 Repeater 生成：

```php
$cards = get_field('quality_worth_cards');
if (!$cards) {
    $cards = get_field('quality_worth_cards_default', 'option');
}
```

遍历 `$cards`，对每个卡片输出一列：  
保持现有 `.elementor-column`、`.elementor-inner-section`、SVG 容器 `elementor-widget-icon` 的结构；  
仅将标题和描述替换为 ACF 字段。  
若图标使用的是 SVG 字符串，可以直接 `echo $card['icon_svg'];`，并保留现有 `<svg>` 尺寸。

### 6.4 Supply Chain 模块：quality-manufacturing-supply-chain.php

1. 标题区

```php
$supply_badge = get_field('quality_supply_badge') ?: get_field('quality_supply_badge_default', 'option');
$supply_title = get_field('quality_supply_title') ?: get_field('quality_supply_title_default', 'option');
```

2. 01 段（We Always Ready）

```php
$order_1 = get_field('quality_supply_1_order') ?: get_field('quality_supply_1_order_default', 'option');
$title_1 = get_field('quality_supply_1_title') ?: get_field('quality_supply_1_title_default', 'option');
$text_1  = get_field('quality_supply_1_text')  ?: get_field('quality_supply_1_text_default', 'option');
$image_1 = get_field('quality_supply_1_image');
if (!$image_1) {
    $image_1 = get_field('quality_supply_1_image_default', 'option');
}
```

3. 02 段（One-Stop Solution）

同理：

```php
$order_2 = get_field('quality_supply_2_order') ?: get_field('quality_supply_2_order_default', 'option');
$title_2 = get_field('quality_supply_2_title') ?: get_field('quality_supply_2_title_default', 'option');
$text_2  = get_field('quality_supply_2_text')  ?: get_field('quality_supply_2_text_default', 'option');
$image_2 = get_field('quality_supply_2_image');
if (!$image_2) {
    $image_2 = get_field('quality_supply_2_image_default', 'option');
}
```

4. 结构与样式

在输出时：

- 保持所有 `.elementor-section` / `.elementor-column` / `.elementor-widget` / `data-id` / `data-settings` 属性不变；  
- 仅替换 `<p>`、`<h3>`、`<img>` 的内容；  
- 图片同样可使用 `wp_get_attachment_image()` 或构造 `img` 标签，保留原有 class。

---

## 七、跨页面联动设计

结合已经完成的关于我们 / 工厂 / FAQ / 项目案例动态化方案，质量制造页面可以参与如下联动：

1. Quality Manufacturing 页面引用 `quality_page_ref`
   - 在 About、工厂或项目案例页面中，如果需要引导用户了解生产质量，可通过 `quality_page_ref` 生成“了解质量制造”按钮链接；  
   - 避免写死 `/quality-manufacturing/`。

2. 联系弹窗与全局 CTA
   - CONTACT US 按钮的文案与弹窗 ID 复用全局 CTA 字段（见工厂方案中的 `global_contact_popup_id` 等），保证多页一致；  
   - `shared-contact-popup.php` 模块在多个页面中统一调用，维护一份标准弹窗结构。

3. 与项目案例的联动
   - 可在质量制造页面底部增加“查看我们的项目案例”按钮，链接来源于全局 `project_page_ref`（见项目案例动态化方案）；  
   - 将质量承诺 → 实际项目成果串成一条路径。

4. 与 FAQ 页的联动
   - 在 Supply Chain 段落旁增加“查看常见问题”链接，链接到 `faq_page_ref` 对应页面；  
   - 让用户在看到质量与供应链介绍后，能快速查阅更多疑问。

---

## 八、实施步骤建议

1. 在 ACF 中的 Options Page 新增字段组「质量制造全局设置」，按第 4 部分配置字段，并将现有静态文案/图片录入为默认值；  
2. 在 Quality Manufacturing 页面上新增字段组「质量制造页面设置」，按第 5 部分配置字段；  
3. 确认全站 `Page Hero 通用配置` 字段组已经存在（参考《关于我们动态化方案》），Hero 部分可逐步迁移到通用组件；  
4. 修改以下模板接入 ACF 数据：
   - `quality-manufacturing-hero.php`：将 `Quality Manufacturing` 替换为 Hero 字段；  
   - `quality-manufacturing-intro.php`：动态输出小标题/主标题/正文/图片，按钮复用全局 CTA 设置；  
   - `quality-manufacturing-worth-invest.php`：动态输出标题和 3 列价值卡片；  
   - `quality-manufacturing-supply-chain.php`：动态输出标题、两段编号/标题/正文和图片；
5. 保留 `page-quality-manufacturing.php` 中的懒加载脚本和 Woo / TRP 脚本，不拆到模块文件；  
6. 在其他页面（About / Factory / Project / FAQ）中，如需增加 Quality Manufacturing 的入口或引用，使用 `quality_page_ref` 和已有的全局引用字段生成链接；  
7. 最后在后台填写并调整各字段内容，逐步替换静态文案，确认前端展示与原版视觉和动效一致。

---

通过以上方案，质量制造页面在不改变现有前端结构和动画的前提下，实现了内容动态化、组件复用以及跨页面联动的基础设计，为后续扩展和运营提供了足够的灵活性。

